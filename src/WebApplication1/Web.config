<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <sectionGroup name="elmah">
      <section name="security" requirePermission="false" type="Elmah.SecuritySectionHandler, Elmah" />
      <section name="errorLog" requirePermission="false" type="Elmah.ErrorLogSectionHandler, Elmah" />
      <section name="errorMail" requirePermission="false" type="Elmah.ErrorMailSectionHandler, Elmah" />
      <section name="errorFilter" requirePermission="false" type="Elmah.ErrorFilterSectionHandler, Elmah" />
    </sectionGroup>
  </configSections>
  <appSettings>
    <add key="VirusFoundEvent" value="vba32.virus.found" />
    <add key="Service" value="VbaTaskAssignment.Service" />
    <add key="Vba32SS" value="ipc://Vba32SS/Vba32SS.rem" />
    <add key="Version" value="2.0.0.0" />
    <add key="ErrorLog" value="error.log" />
  <!-- Дефолтные свойства для profile -->
    <add key="Culture" value="en-US" />
    <add key="MasterPage" value="mstrPageNew.master" />
    <add key="Theme" value="Main" />
  
  </appSettings>
  <connectionStrings configSource="ConnectionStrings.config" />
  <elmah>
    <security allowRemoteAccess="1" />
    <errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="ARM2DataBase" />
  </elmah>
  <system.web>
  <pages controlRenderingCompatibilityVersion="3.5" clientIDMode="AutoID">
      <controls>
        <add namespace="AjaxControlToolkit" assembly="AjaxControlToolkit" tagPrefix="ajaxToolkit" />
      </controls>
    </pages>
    <compilation debug="true" targetFramework="4.0" batch="false">
      <assemblies>
        <add assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
        <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
        <add assembly="System.Drawing.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="System.Management, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="System.DirectoryServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="System.ServiceProcess, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="Microsoft.JScript, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="System.Data.Services.Client, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
      </assemblies>
  </compilation>
    <roleManager enabled="true" cacheRolesInCookie="false" />
    <sessionState timeout="40" />
    <authentication mode="Forms">
      <forms name=".ASPXFORMSAUTH" loginUrl="Logins.aspx" />
    </authentication>
    <authorization>
      <deny users="?" />
    </authorization>
    <identity impersonate="true" />
    <siteMap defaultProvider="AspNetXmlSiteMapProvider" enabled="true">
      <providers>
        <remove name="AspNetXmlSiteMapProvider" />
        <add name="AspNetXmlSiteMapProvider" type="System.Web.XmlSiteMapProvider" securityTrimmingEnabled="true" siteMapFile="Web.sitemap" />
      </providers>
    </siteMap>
    <!-- Функционал для профайла-->
    <membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="15">
      <providers>
        <clear />
        <add name="SqlProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="LocalSqlServer" applicationName="VbaControlCenter" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="true" passwordFormat="Hashed" />
      </providers>
    </membership>
    <!-- Профайл -->
    <anonymousIdentification enabled="false" />
    <profile inherits="GreateProfile.ProfileCommon" >
      <!--<properties>
        <add name="FirstName" />
        <add name="LastName" />
        <add name="LastVisit" type="DateTime" />
        <add name="Culture" defaultValue="en-US" />
        <add name="MasterPage" defaultValue="mstrPageNew.master" />
        <add name="Theme" defaultValue="Main" />
        <add name="Settings" />
        <add name="CompFilters" />
        <add name="GroupFilters" />
        <add name="EventFilters" />
        <add name="TaskFilters" />
        <add name="TasksInstallFilters" />
        <add name="ComponentFilters" />
        <add name="ProcessFilters" />
        <add name="TasksList" />
        <add name="ComputerColorOptions" />
        <add name="DeviceFilters" />
        <add name="UnknownDeviceFilters" />
        <add name="DiagramFilters" />
        <add name="DeviceClassFilters" />
      </properties>-->
    </profile>
    <httpHandlers>
      <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
    </httpHandlers>
    <httpModules>
      <add name="HTTPModule_Clearer" type="HTMLClearer.HTTPModule_Clearer" />
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
    </httpModules>
    <!-- Необходимо для передачи файлов.
        Здесь задано максимально возможное значение.   
    -->
    <httpRuntime maxRequestLength="2097151" />
    <!--<customErrors mode="On" defaultRedirect="Error.aspx" />-->
  <customErrors mode="Off" defaultRedirect="Error.aspx" />
  </system.web>
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <modules runAllManagedModulesForAllRequests="true">
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
    </modules>
    <handlers>
      <add name="Elmah" verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" preCondition="integratedMode" />
    </handlers>
  </system.webServer>
  <location path="GetPolicy.aspx">
    <system.web>
      <authorization>
        <allow users="*" />
      </authorization>
    </system.web>
  </location>
  <location path="Downloads">
    <system.web>
      <authorization>
        <allow users="*" />
      </authorization>
    </system.web>
  </location>
  <location path="elmah.axd">
    <system.web>
      <authorization>
        <allow roles="administrator" />
        <deny users="*" />
      </authorization>
    </system.web>
  </location>
  <location path="App_Themes">
    <system.web>
      <authorization>
        <allow users="?" />
      </authorization>
    </system.web>
  </location>
  <location path="js">
    <system.web>
      <authorization>
        <allow users="?" />
      </authorization>
    </system.web>
  </location>
</configuration>